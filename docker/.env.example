# ============================================================
# Yii3 + RoadRunner Docker Compose 配置模板
# ============================================================
# 使用方法:
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 根据需要修改配置值
# 3. 运行: docker-compose up -d

# ============================================================
# Docker Compose 通用配置
# ============================================================
COMPOSE_PROJECT_NAME=yii3-project
COMPOSE_FILE=docker-compose.yml
RESTART_POLICY=unless-stopped
LOG_DRIVER=json-file
LOG_MAX_SIZE=100m
LOG_MAX_FILE=10

# ============================================================
# 应用配置
# ============================================================
APP_ENV=production
APP_DEBUG=false
APP_HTTP_PORT=8080
APP_CONTAINER_NAME=yii3-app

# ============================================================
# PostgreSQL 数据库配置
# ============================================================
POSTGRES_IMAGE=postgres:15-alpine
POSTGRES_CONTAINER_NAME=yii3-postgres
DB_HOST=postgres
DB_PORT=5432
DB_NAME=yii3
DB_USER=yii3
DB_PASSWORD=your_database_password_here
POSTGRES_DATA_VOLUME=yii3-postgres-data
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_LOG_MIN_DURATION_STATEMENT=-1

# ============================================================
# Redis 缓存配置
# ============================================================
REDIS_IMAGE=redis:7-alpine
REDIS_CONTAINER_NAME=yii3-redis
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_DATA_VOLUME=yii3-redis-data
REDIS_MAX_MEMORY=512mb
REDIS_MAXMEMORY_POLICY=allkeys-lru
REDIS_APPENDONLY=yes

# ============================================================
# MinIO 对象存储配置
# ============================================================
MINIO_IMAGE=minio/minio:latest
MINIO_CONTAINER_NAME=yii3-minio
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_BUCKET=yii3-uploads
MINIO_DATA_VOLUME=yii3-minio-data
MINIO_USE_SSL=false
MINIO_REGION=us-east-1
MINIO_SERVER_URL=http://localhost:9000
MINIO_CONSOLE_URL=http://localhost:9001

# ============================================================
# NATS 消息队列配置
# ============================================================
NATS_IMAGE=nats:2.10-alpine
NATS_CONTAINER_NAME=yii3-nats
NATS_URL=nats://nats:4222
NATS_PORT=4222
NATS_MONITORING_PORT=8222
NATS_WEBSOCKET_PORT=6222
NATS_DATA_VOLUME=yii3-nats-data
NATS_STREAM_NAME=yii3-stream
NATS_CONSUMER_NAME=yii3-consumer
NATS_ENABLE_AUTH=false
NATS_USER=
NATS_PASSWORD=
NATS_MAX_PAYLOAD=1048576
NATS_MAX_CONNECTIONS=65536

# ============================================================
# Docker 资源限制配置
# ============================================================
APP_MEMORY_LIMIT=512m
APP_CPU_LIMIT=1.0
APP_MEMORY_RESERVATION=256m
APP_CPU_RESERVATION=0.5

POSTGRES_MEMORY_LIMIT=1g
POSTGRES_CPU_LIMIT=1.0
POSTGRES_MEMORY_RESERVATION=512m
POSTGRES_CPU_RESERVATION=0.5

REDIS_MEMORY_LIMIT=512m
REDIS_CPU_LIMIT=0.5
REDIS_MEMORY_RESERVATION=256m
REDIS_CPU_RESERVATION=0.25

MINIO_MEMORY_LIMIT=1g
MINIO_CPU_LIMIT=1.0
MINIO_MEMORY_RESERVATION=512m
MINIO_CPU_RESERVATION=0.5

NATS_MEMORY_LIMIT=512m
NATS_CPU_LIMIT=0.5
NATS_MEMORY_RESERVATION=256m
NATS_CPU_RESERVATION=0.25

# ============================================================
# 网络配置
# ============================================================
NETWORK_NAME=yii3-network
NETWORK_DRIVER=bridge

# ============================================================
# 健康检查配置
# ============================================================
HEALTHCHECK_INTERVAL=30
HEALTHCHECK_TIMEOUT=10
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=10

# ============================================================
# 时区和地区配置
# ============================================================
TZ=Asia/Shanghai
LANG=en_US.UTF-8
LC_ALL=en_US.UTF-8
